import{S as e,i as n,s as t,l as o,f as l,G as s,d as r,A as c,H as a,I as i,J as u,e as h,t as d,k as g,c as f,a as v,g as p,n as y,E,h as m,K as I,b as S,L as w,M as x,N as b}from"../chunks/vendor-a0d02d92.js";import{S as T}from"../chunks/Server-039a48e0.js";function k(e,n,t){const o=e.slice();return o[26]=n[t],o[27]=n,o[28]=t,o}function D(e,n,t){const o=e.slice();return o[29]=n[t],o[30]=n,o[31]=t,o}function N(e){let n,t,o,s,c,a,i,u,m,T,D,N=[...e[2]].reverse(),V=[];for(let l=0;l<N.length;l+=1)V[l]=L(k(e,N,l));return{c(){n=h("div"),t=h("div"),o=h("div");for(let e=0;e<V.length;e+=1)V[e].c();s=g(),c=h("div"),a=h("input"),i=g(),u=h("button"),m=d("Send"),this.h()},l(e){n=f(e,"DIV",{class:!0});var l=v(n);t=f(l,"DIV",{class:!0});var h=v(t);o=f(h,"DIV",{class:!0});var d=v(o);for(let n=0;n<V.length;n+=1)V[n].l(d);d.forEach(r),s=y(h),c=f(h,"DIV",{class:!0});var g=v(c);a=f(g,"INPUT",{class:!0}),i=y(g),u=f(g,"BUTTON",{class:!0});var E=v(u);m=p(E,"Send"),E.forEach(r),g.forEach(r),h.forEach(r),l.forEach(r),this.h()},h(){S(o,"class","flex-grow overflow-scroll p-1"),S(a,"class","bg-gray-700 rounded p-1 flex-grow"),S(u,"class","mx-4 p-1 px-2 rounded bg-gray-700 hover:bg-gray-800"),S(c,"class","flex mt-2"),S(t,"class","w-2/3 bg-gray-800 rounded m-5 p-5 h-[50rem] flex-col flex"),S(n,"class","w-full flex justify-center")},m(r,h){l(r,n,h),E(n,t),E(t,o);for(let e=0;e<V.length;e+=1)V[e].m(o,null);e[21](o),E(t,s),E(t,c),E(c,a),w(a,e[6]),E(c,i),E(c,u),E(u,m),T||(D=[x(a,"input",e[22]),x(a,"keydown",e[23]),x(u,"click",e[24])],T=!0)},p(e,n){if(132&n[0]){let t;for(N=[...e[2]].reverse(),t=0;t<N.length;t+=1){const l=k(e,N,t);V[t]?V[t].p(l,n):(V[t]=L(l),V[t].c(),V[t].m(o,null))}for(;t<V.length;t+=1)V[t].d(1);V.length=N.length}64&n[0]&&a.value!==e[6]&&w(a,e[6])},d(t){t&&r(n),I(V,t),e[21](null),T=!1,b(D)}}}function V(e){let n,t,o,s,c,a,i,u,m,I,T,k,D;return{c(){n=h("div"),t=h("div"),o=d("You are not logged in. To login type "),s=h("code"),c=d("/login"),a=d(" on the server and enter your code here"),i=g(),u=h("input"),m=g(),I=h("button"),T=d("Login"),this.h()},l(e){n=f(e,"DIV",{});var l=v(n);t=f(l,"DIV",{});var h=v(t);o=p(h,"You are not logged in. To login type "),s=f(h,"CODE",{});var d=v(s);c=p(d,"/login"),d.forEach(r),a=p(h," on the server and enter your code here"),h.forEach(r),i=y(l),u=f(l,"INPUT",{class:!0}),m=y(l),I=f(l,"BUTTON",{class:!0});var g=v(I);T=p(g,"Login"),g.forEach(r),l.forEach(r),this.h()},h(){S(u,"class","bg-gray-700 rounded p-1"),S(I,"class","mx-4 p-1 px-2 rounded bg-gray-700 hover:bg-gray-800")},m(r,h){l(r,n,h),E(n,t),E(t,o),E(t,s),E(s,c),E(t,a),E(n,i),E(n,u),w(u,e[5]),E(n,m),E(n,I),E(I,T),k||(D=[x(u,"input",e[17]),x(u,"keydown",e[18]),x(I,"click",e[19])],k=!0)},p(e,n){32&n[0]&&u.value!==e[5]&&w(u,e[5])},d(e){e&&r(n),k=!1,b(D)}}}function C(e){let n,t,o,s,c,a,i,u,m,I;return{c(){n=h("div"),t=h("div"),o=d("Enter server name"),s=g(),c=h("input"),a=g(),i=h("button"),u=d("Connect"),this.h()},l(e){n=f(e,"DIV",{class:!0});var l=v(n);t=f(l,"DIV",{class:!0});var h=v(t);o=p(h,"Enter server name"),h.forEach(r),s=y(l),c=f(l,"INPUT",{class:!0}),a=y(l),i=f(l,"BUTTON",{class:!0});var d=v(i);u=p(d,"Connect"),d.forEach(r),l.forEach(r),this.h()},h(){S(t,"class","pr-5"),S(c,"class","bg-gray-700 rounded p-1"),S(i,"class","mx-4 p-1 px-2 rounded bg-gray-700 hover:bg-gray-800"),S(n,"class","flex pt-5")},m(r,h){l(r,n,h),E(n,t),E(t,o),E(n,s),E(n,c),w(c,e[4]),E(n,a),E(n,i),E(i,u),m||(I=[x(c,"input",e[14]),x(c,"keydown",e[15]),x(i,"click",e[16])],m=!0)},p(e,n){16&n[0]&&c.value!==e[4]&&w(c,e[4])},d(e){e&&r(n),m=!1,b(I)}}}function O(e){let n,t,o,s=e[29].replace(/^Â/g,"").replace(/§./g,"")+"",c=e[28],a=e[31];const i=()=>e[20](n,c,a),u=()=>e[20](null,c,a);return{c(){n=h("div"),t=d(s),o=g()},l(e){n=f(e,"DIV",{});var l=v(n);t=p(l,s),o=y(l),l.forEach(r)},m(e,s){l(e,n,s),E(n,t),E(n,o),i()},p(n,o){e=n,4&o[0]&&s!==(s=e[29].replace(/^Â/g,"").replace(/§./g,"")+"")&&m(t,s),c===e[28]&&a===e[31]||(u(),c=e[28],a=e[31],i())},d(e){e&&r(n),u()}}}function L(e){let n,t=e[26],s=[];for(let o=0;o<t.length;o+=1)s[o]=O(D(e,t,o));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();n=o()},l(e){for(let n=0;n<s.length;n+=1)s[n].l(e);n=o()},m(e,t){for(let n=0;n<s.length;n+=1)s[n].m(e,t);l(e,n,t)},p(e,o){if(132&o[0]){let l;for(t=e[26],l=0;l<t.length;l+=1){const r=D(e,t,l);s[l]?s[l].p(r,o):(s[l]=O(r),s[l].c(),s[l].m(n.parentNode,n))}for(;l<s.length;l+=1)s[l].d(1);s.length=t.length}},d(e){I(s,e),e&&r(n)}}}function U(e){let n;function t(e,n){return e[0]?e[1]?N:V:C}let c=t(e),a=c(e);return{c(){a.c(),n=o()},l(e){a.l(e),n=o()},m(e,t){a.m(e,t),l(e,n,t)},p(e,o){c===(c=t(e))&&a?a.p(e,o):(a.d(1),a=c(e),a&&(a.c(),a.m(n.parentNode,n)))},i:s,o:s,d(e){a.d(e),e&&r(n)}}}function H(e,n,t){var o=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(l,s){function r(e){try{a(o.next(e))}catch(n){s(n)}}function c(e){try{a(o.throw(e))}catch(n){s(n)}}function a(e){var n;e.done?l(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}))};let l,s,r=!1,h="",d=!1,g="",f="",v=[],p=[],y=!1,E=!1;c((()=>{let e=localStorage.getItem("host");null!==e&&m(e),null!==localStorage.getItem("authID")&&t(1,d=!0)})),a((()=>{l&&l.ws.close()}));const m=e=>{localStorage.setItem("host",e),t(11,l=new T(e)),l.on("LOGIN_SUCCESS",(()=>{t(1,d=!0),l.requestHistory(),t(12,y=!0),console.log("Login Success")})),l.on("HISTORY_DATA",(e=>o(void 0,void 0,void 0,(function*(){let n=e.slice(-1)[0],o=e.slice(0,-1).reverse();0===o.length&&t(13,E=!0),t(2,v[+n-1]=o,v),1==+n?(yield i(),p.slice(-1)[0]&&p.slice(-1)[0].scrollIntoView()):p.slice(100)[0]&&p.slice(100)[0].scrollIntoView(),t(12,y=!1),console.log("Received History",n,v[+n-1].length)})))),l.on("OPEN",(()=>{t(0,r=!0),d&&(l.requestHistory(1),t(12,y=!0)),console.log("Connection Opened")})),l.on("CLOSE",(()=>{t(0,r=!1),l.ws.close(),console.log("Connection Closed")})),l.on("WS_MESSAGE",(e=>{})),l.on("NEW_MESSAGE",(e=>o(void 0,void 0,void 0,(function*(){v[0].push(e[0]),t(2,v),yield i(),p.slice(-1)[0]&&p.slice(-1)[0].scrollIntoView(),console.log("Received Message: ",e[0])}))))},I=e=>{l&&l.login(e)},S=e=>{l&&l.sendMessage(e)};return e.$$.update=()=>{14351&e.$$.dirty[0]&&d&&r&&i().then((()=>{s.addEventListener("scroll",(()=>{s.scrollTop<200&&!y&&!E&&(t(12,y=!0),l.requestHistory(v.length+1))}))}))},[r,d,v,s,h,g,f,p,m,I,S,l,y,E,function(){h=this.value,t(4,h)},e=>{"Enter"===e.key&&(m(h),t(4,h=""))},()=>{m(h),t(4,h="")},function(){g=this.value,t(5,g)},e=>{"Enter"===e.key&&(I(g),t(5,g=""))},()=>{I(g),t(5,g="")},function(e,n,o){u[e?"unshift":"push"]((()=>{p[100*n+o]=e,t(7,p)}))},function(e){u[e?"unshift":"push"]((()=>{s=e,t(3,s)}))},function(){f=this.value,t(6,f)},e=>{"Enter"===e.key&&(S(f),t(6,f=""))},()=>{S(f),t(6,f="")}]}export default class extends e{constructor(e){super(),n(this,e,H,U,t,{},[-1,-1])}}
