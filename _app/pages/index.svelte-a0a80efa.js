import{S as e,i as t,s,e as n,t as l,k as o,c as r,a,g as i,d as c,n as h,b as u,f as g,F as d,G as f,z as v,H as p,I as y,l as E,h as I,J as S,K as m,L as w,M as D}from"../chunks/vendor-7a65b8a7.js";class x{constructor(e,t=31661){this.listeners={},this.authID=localStorage.getItem("authID"),this.ws=new WebSocket(`wss://${e}:${t}`),this.ws.onopen=e=>this.callListeners("OPEN",e),this.ws.onclose=e=>this.callListeners("CLOSE",e),this.ws.onmessage=e=>this.callListeners("WS_MESSAGE",e),this.ws.onerror=e=>this.callListeners("ERROR",e),this.on("WS_MESSAGE",this.handleMessage.bind(this)),this.on("LOGIN_SUCCESS",this.handleLogin.bind(this)),this.on("OPEN",(e=>{this.ws.send(JSON.stringify({type:"AUTH",authID:this.authID}))}))}on(e,t){null==this.listeners[e]?this.listeners[e]=[t]:this.listeners[e].push(t)}login(e){console.log("Logging in with code",e),console.log(this.listeners),this.ws.send(JSON.stringify({type:"LOGIN",data:[e]}))}requestHistory(e=1){console.log("Requesting History",e),this.ws.send(JSON.stringify({type:"GET_HISTORY",data:[e],authID:this.authID}))}sendMessage(e){console.log("Sending message",e),this.ws.send(JSON.stringify({type:"SEND",data:[e],authID:this.authID}))}callListeners(e,t){this.listeners[e]&&this.listeners[e].forEach((e=>e(t)))}handleMessage(e){const t=JSON.parse(e.data);this.callListeners(t.type,t.data)}handleLogin(e){this.authID=e[0],localStorage.setItem("authID",this.authID)}}function O(e,t,s){const n=e.slice();return n[28]=t[s],n[29]=t,n[30]=s,n}function N(e,t,s){const n=e.slice();return n[31]=t[s],n[32]=t,n[33]=s,n}function L(e){let t,s,f,v,p,y,E,I,x,N,L,b=[...e[2]].reverse(),T=[];for(let n=0;n<b.length;n+=1)T[n]=V(O(e,b,n));return{c(){t=n("div"),s=n("div"),f=n("div");for(let e=0;e<T.length;e+=1)T[e].c();v=o(),p=n("div"),y=n("input"),E=o(),I=n("button"),x=l("Send"),this.h()},l(e){t=r(e,"DIV",{class:!0});var n=a(t);s=r(n,"DIV",{class:!0});var l=a(s);f=r(l,"DIV",{class:!0});var o=a(f);for(let t=0;t<T.length;t+=1)T[t].l(o);o.forEach(c),v=h(l),p=r(l,"DIV",{class:!0});var u=a(p);y=r(u,"INPUT",{class:!0}),E=h(u),I=r(u,"BUTTON",{class:!0});var g=a(I);x=i(g,"Send"),g.forEach(c),u.forEach(c),l.forEach(c),n.forEach(c),this.h()},h(){u(f,"class","flex-grow overflow-scroll p-1"),u(y,"class","bg-gray-700 rounded p-1 flex-grow"),u(I,"class","mx-4 p-1 px-2 rounded bg-gray-700 hover:bg-gray-800"),u(p,"class","flex mt-2"),u(s,"class","w-2/3 bg-gray-800 rounded m-5 p-5 h-[50rem] flex-col flex"),u(t,"class","w-full flex justify-center")},m(n,l){g(n,t,l),d(t,s),d(s,f);for(let e=0;e<T.length;e+=1)T[e].m(f,null);e[21](f),d(s,v),d(s,p),d(p,y),m(y,e[6]),d(p,E),d(p,I),d(I,x),N||(L=[w(y,"input",e[22]),w(y,"keydown",e[23]),w(I,"click",e[24])],N=!0)},p(e,t){if(132&t[0]){let s;for(b=[...e[2]].reverse(),s=0;s<b.length;s+=1){const n=O(e,b,s);T[s]?T[s].p(n,t):(T[s]=V(n),T[s].c(),T[s].m(f,null))}for(;s<T.length;s+=1)T[s].d(1);T.length=b.length}64&t[0]&&y.value!==e[6]&&m(y,e[6])},d(s){s&&c(t),S(T,s),e[21](null),N=!1,D(L)}}}function b(e){let t,s,f,v,p,y,E,I,S,x,O,N,L;return{c(){t=n("div"),s=n("div"),f=l("You are not logged in. To login type "),v=n("code"),p=l("/login"),y=l(" on the server and enter your code here"),E=o(),I=n("input"),S=o(),x=n("button"),O=l("Login"),this.h()},l(e){t=r(e,"DIV",{});var n=a(t);s=r(n,"DIV",{});var l=a(s);f=i(l,"You are not logged in. To login type "),v=r(l,"CODE",{});var o=a(v);p=i(o,"/login"),o.forEach(c),y=i(l," on the server and enter your code here"),l.forEach(c),E=h(n),I=r(n,"INPUT",{class:!0}),S=h(n),x=r(n,"BUTTON",{class:!0});var u=a(x);O=i(u,"Login"),u.forEach(c),n.forEach(c),this.h()},h(){u(I,"class","bg-gray-700 rounded p-1"),u(x,"class","mx-4 p-1 px-2 rounded bg-gray-700 hover:bg-gray-800")},m(n,l){g(n,t,l),d(t,s),d(s,f),d(s,v),d(v,p),d(s,y),d(t,E),d(t,I),m(I,e[5]),d(t,S),d(t,x),d(x,O),N||(L=[w(I,"input",e[17]),w(I,"keydown",e[18]),w(x,"click",e[19])],N=!0)},p(e,t){32&t[0]&&I.value!==e[5]&&m(I,e[5])},d(e){e&&c(t),N=!1,D(L)}}}function T(e){let t,s,f,v,p,y,E,I,S,x;return{c(){t=n("div"),s=n("div"),f=l("Enter server name"),v=o(),p=n("input"),y=o(),E=n("button"),I=l("Connect"),this.h()},l(e){t=r(e,"DIV",{class:!0});var n=a(t);s=r(n,"DIV",{class:!0});var l=a(s);f=i(l,"Enter server name"),l.forEach(c),v=h(n),p=r(n,"INPUT",{class:!0}),y=h(n),E=r(n,"BUTTON",{class:!0});var o=a(E);I=i(o,"Connect"),o.forEach(c),n.forEach(c),this.h()},h(){u(s,"class","pr-5"),u(p,"class","bg-gray-700 rounded p-1"),u(E,"class","mx-4 p-1 px-2 rounded bg-gray-700 hover:bg-gray-800"),u(t,"class","flex pt-5")},m(n,l){g(n,t,l),d(t,s),d(s,f),d(t,v),d(t,p),m(p,e[4]),d(t,y),d(t,E),d(E,I),S||(x=[w(p,"input",e[14]),w(p,"keydown",e[15]),w(E,"click",e[16])],S=!0)},p(e,t){16&t[0]&&p.value!==e[4]&&m(p,e[4])},d(e){e&&c(t),S=!1,D(x)}}}function C(e){let t,s,u,f=e[31].replace(/^Â/g,"").replace(/§./g,"")+"",v=e[30],p=e[33];const y=()=>e[20](t,v,p),E=()=>e[20](null,v,p);return{c(){t=n("div"),s=l(f),u=o()},l(e){t=r(e,"DIV",{});var n=a(t);s=i(n,f),u=h(n),n.forEach(c)},m(e,n){g(e,t,n),d(t,s),d(t,u),y()},p(t,n){e=t,4&n[0]&&f!==(f=e[31].replace(/^Â/g,"").replace(/§./g,"")+"")&&I(s,f),v===e[30]&&p===e[33]||(E(),v=e[30],p=e[33],y())},d(e){e&&c(t),E()}}}function V(e){let t,s=e[28],n=[];for(let l=0;l<s.length;l+=1)n[l]=C(N(e,s,l));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=E()},l(e){for(let t=0;t<n.length;t+=1)n[t].l(e);t=E()},m(e,s){for(let t=0;t<n.length;t+=1)n[t].m(e,s);g(e,t,s)},p(e,l){if(132&l[0]){let o;for(s=e[28],o=0;o<s.length;o+=1){const r=N(e,s,o);n[o]?n[o].p(r,l):(n[o]=C(r),n[o].c(),n[o].m(t.parentNode,t))}for(;o<n.length;o+=1)n[o].d(1);n.length=s.length}},d(e){S(n,e),e&&c(t)}}}function k(e){let t,s,v,p;function y(e,t){return e[0]?e[1]?L:b:T}let E=y(e),I=E(e);return{c(){t=n("div"),s=n("div"),v=l("Minecraft Server Control Panel"),p=o(),I.c(),this.h()},l(e){t=r(e,"DIV",{class:!0});var n=a(t);s=r(n,"DIV",{class:!0});var l=a(s);v=i(l,"Minecraft Server Control Panel"),l.forEach(c),p=h(n),I.l(n),n.forEach(c),this.h()},h(){u(s,"class","text-2xl text-center"),u(t,"class","text-white p-5")},m(e,n){g(e,t,n),d(t,s),d(s,v),d(t,p),I.m(t,null)},p(e,s){E===(E=y(e))&&I?I.p(e,s):(I.d(1),I=E(e),I&&(I.c(),I.m(t,null)))},i:f,o:f,d(e){e&&c(t),I.d()}}}function M(e,t,s){var n=this&&this.__awaiter||function(e,t,s,n){return new(s||(s=Promise))((function(l,o){function r(e){try{i(n.next(e))}catch(t){o(t)}}function a(e){try{i(n.throw(e))}catch(t){o(t)}}function i(e){var t;e.done?l(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}i((n=n.apply(e,t||[])).next())}))};let l,o,r=!1,a="",i=!1,c="",h="",u=[],g=[],d=!1,f=!1;v((()=>{null!=localStorage.getItem("theme")?localStorage.getItem("theme"):window.matchMedia("(prefers-color-scheme: dark)").matches;let e=localStorage.getItem("host");null!==e&&E(e),null!==localStorage.getItem("authID")&&s(1,i=!0)}));const E=e=>{localStorage.setItem("host",e),s(11,l=new x(e)),l.on("LOGIN_SUCCESS",(()=>{s(1,i=!0),l.requestHistory(),s(12,d=!0),console.log("Login Success")})),l.on("HISTORY_DATA",(e=>n(void 0,void 0,void 0,(function*(){let t=e.slice(-1)[0],n=e.slice(0,-1).reverse();0===n.length&&s(13,f=!0),s(2,u[+t-1]=n,u),1==+t?(yield p(),g.slice(-1)[0]&&g.slice(-1)[0].scrollIntoView()):g.slice(100)[0]&&g.slice(100)[0].scrollIntoView(),s(12,d=!1),console.log("Received History",t,u[+t-1].length)})))),l.on("OPEN",(()=>{s(0,r=!0),i&&(l.requestHistory(1),s(12,d=!0)),console.log("Connection Opened")})),l.on("CLOSE",(()=>{s(0,r=!1),l.ws.close(),console.log("Connection Closed")})),l.on("WS_MESSAGE",(e=>{})),l.on("NEW_MESSAGE",(e=>n(void 0,void 0,void 0,(function*(){u[0].push(e[0]),s(2,u),yield p(),g.slice(-1)[0]&&g.slice(-1)[0].scrollIntoView(),console.log("Received Message: ",e[0])}))))},I=e=>{l&&l.login(e)},S=e=>{l&&l.sendMessage(e)};return e.$$.update=()=>{14351&e.$$.dirty[0]&&i&&r&&p().then((()=>{o.addEventListener("scroll",(()=>{o.scrollTop<200&&!d&&!f&&(s(12,d=!0),l.requestHistory(u.length+1))}))}))},[r,i,u,o,a,c,h,g,E,I,S,l,d,f,function(){a=this.value,s(4,a)},e=>{"Enter"===e.key&&(E(a),s(4,a=""))},()=>{E(a),s(4,a="")},function(){c=this.value,s(5,c)},e=>{"Enter"===e.key&&(I(c),s(5,c=""))},()=>{I(c),s(5,c="")},function(e,t,n){y[e?"unshift":"push"]((()=>{g[100*t+n]=e,s(7,g)}))},function(e){y[e?"unshift":"push"]((()=>{o=e,s(3,o)}))},function(){h=this.value,s(6,h)},e=>{"Enter"===e.key&&(S(h),s(6,h=""))},()=>{S(h),s(6,h="")}]}export default class extends e{constructor(e){super(),t(this,e,M,k,s,{},[-1,-1])}}
